#include <string>

#include "endgame_square_permutations.hxx"

//#include "algorithm_best_permutation.hxx"
//#include "burrows_wheeler.hxx"

int REMAP_BOUND_KING[64] =
{ 0, 1, 2, 3,-1,-1,-1,-1,
  4, 5, 6, 7,-1,-1,-1,-1,
  8, 9,10,11,-1,-1,-1,-1,
 12,13,14,15,-1,-1,-1,-1,
 16,17,18,19,-1,-1,-1,-1,
 20,21,22,23,-1,-1,-1,-1,
 24,25,26,27,-1,-1,-1,-1,
 28,29,30,31,-1,-1,-1,-1 };
int INV_REMAP_BOUND_KING[64] =
{ 0, 1, 2, 3, 8, 9,10,11,
 16,17,18,19,24,25,26,27,
 32,33,34,35,40,41,42,43,
 48,49,50,51,56,57,58,59,
 -1,-1,-1,-1,-1,-1,-1,-1,
 -1,-1,-1,-1,-1,-1,-1,-1,
 -1,-1,-1,-1,-1,-1,-1,-1,
 -1,-1,-1,-1,-1,-1,-1,-1 };


string mapping_name(int mapping) {
  switch(mapping) {
  case -5: return "Mapping found by Borrows Wheeler algorithm";
  case -4: return "Alg1c";
  case -3: return "Alg1b";
  case -2: return "Alg1";
  case -1: return "Mapping found by genetic algorithm";
  case 0: return "Identity mapping";
  case 1: return "Mapping designed for pawns";
  case 2: return "Mapping designed for bishops";
  case 3: return "Hilbert curve mapping";
  case 4: return "Z curve mapping";
  case 5: return "Mapping found by endgame_KBBK.cxx";
  case 6: return "Pawn mapping found by GA";
  case 7: return "Whirl mapping";
  case 8: return "Modified Z curve";
  }
  return "illegal mapping";
}


// IMPORTANT: The bound king MUST be mapped to a number representable
// with 4 resp. 5 bits (no pawns or pawns).
// Hence only the following mappings may be applied to the bound king:
//     3 (Hilber curve), 4 (Z curve), 8 (Modified Z curve)
uchar mappings[NUM_STD_MAPPINGS][64] = {
  {// 0: Identity mapping
    0, 1, 2, 3, 4, 5, 6, 7,
    8, 9,10,11,12,13,14,15,
   16,17,18,19,20,21,22,23,
   24,25,26,27,28,29,30,31,
   32,33,34,35,36,37,38,39,
   40,41,42,43,44,45,46,47,
   48,49,50,51,52,53,54,55,
   56,57,58,59,60,61,62,63},
  {// 1: Pawn mapping
    2, 0, 3, 1, 9,11, 8,10,
    6, 4, 7, 5,13,15,12,14,
   18,16,19,17,25,27,24,26,
   22,20,23,21,29,31,28,30,
   34,32,35,33,41,43,40,42,
   38,36,39,37,45,47,44,46,
   48,49,50,51,52,53,54,55,
   56,57,58,59,60,61,62,63},
  {// 2: Bishop mapping
    0,47, 3,40, 8,35,15,32,
   54, 2,46, 7,39,14,34,22,
    1,53, 6,45,13,38,21,33,
   59, 5,52,12,44,20,37,27,
    4,58,11,51,19,43,26,36,
   62,10,57,18,50,25,42,30,
    9,61,17,56,24,49,29,41,
   63,16,60,23,55,28,48,31},
  {// 3: Hilbert curve
    0, 3, 4, 5,58,59,60,63,
    1, 2, 7, 6,57,56,61,62,
   14,13, 8, 9,54,55,50,49,
   15,12,11,10,53,52,51,48,
   16,17,30,31,32,33,46,47,
   19,18,29,28,35,34,45,44,
   20,23,24,27,36,39,40,43,
   21,22,25,26,37,38,41,42},
  {// 4: Z curve
    0, 2, 8,10,32,34,40,42,
    1, 3, 9,11,33,35,41,43,
    4, 6,12,14,36,38,44,46,
    5, 7,13,15,37,39,45,47,
   16,18,24,26,48,50,56,58,
   17,19,25,27,49,51,57,59,
   20,22,28,30,52,54,60,62,
   21,23,29,31,53,55,61,63},
    /* Previously version did not satisfy bound king constraint
    0, 1, 4, 5,16,17,20,21,
    2, 3, 6, 7,18,19,22,23,
    8, 9,12,13,24,25,28,29,
   10,11,14,15,26,27,30,31,
   32,33,36,37,40,41,44,45,
   34,35,38,39,42,43,46,47,
   48,49,52,53,56,57,60,61,
   50,51,54,55,58,59,62,63},
    */
  {// 5: Bishop mapping 2
   53,15,35, 1,33, 3,47,21,
   28,52,16,34, 2,48,20,60,
   42,27,51,17,49,19,59,10,
    6,43,26,50,18,58,11,38,
   32, 5,44,25,57,12,37, 0,
    4,45,24,63,31,56,13,36,
   46,23,62, 8,40,30,55,14,
   22,61, 9,39, 7,41,29,54},
  {// 6: Pawn mapping 2. Found by GA
   18,16,22,20,36,39,38,32,
   19,17,23,21,37,35,34,33,
   26,27,30,31,47,46,42,43,
   24,25,28,29,45,44,40,41,
   10, 8,11, 9, 1, 3, 0, 2,
   14,12,15,13, 5, 7, 4, 6,
   54,59,58,52,50,60,63,61,
   55,56,62,53,51,48,49,57},
  {// 7: Whirl mapping
    0, 1, 2, 3,52,36,20, 4,
   16,17,18,19,53,37,21, 5,
   32,33,34,35,54,38,22, 6,
   48,49,50,51,55,39,23, 7,
   15,31,47,63,59,58,57,56,
   14,30,46,62,43,42,41,40,
   13,29,45,61,27,26,25,24,
   12,28,44,60,11,10, 9, 8},
  {// 8: Modified Z curve
    0, 2, 8,10,42,40,34,32,
    1, 3, 9,11,43,41,35,33,
    4, 6,12,14,46,44,38,36,
    5, 7,13,15,47,45,39,37,
   21,23,29,31,63,61,55,53,
   20,22,28,30,62,60,54,52,
   17,19,25,27,59,57,51,49,
   16,18,24,26,58,56,50,48},
  {// 9: King "identity mapping"
    0, 1, 2, 3,32,33,34,35,
    4, 5, 6, 7,36,37,38,39,
    8, 9,10,11,40,41,42,43,
   12,13,14,15,44,45,46,47,
   16,17,18,19,48,49,50,51,
   20,21,22,23,52,53,54,55,
   24,25,26,27,56,57,58,59,
   28,29,30,31,60,61,62,63}
};
